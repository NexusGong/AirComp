---
description: 智能录入功能的产品与实现约定
globs: backend/app/services/doubao.py,backend/app/api/machines.py,frontend/src/views/AddClient.vue,frontend/src/views/AddSupplier.vue
alwaysApply: false
---

# 智能录入（能耗计算设备）

## 核心能力要求

**智能录入必须具备「从多个列中抽取到所需列」的能力。**

- 用户粘贴或上传的表格/文本可能包含**多种表头命名**（如「公司」「单位名称」「客户」→ 公司名称；「功率」「额定功率(kW)」「电机功率」→ 额定功率）。
- 实现时（含豆包 system prompt、前端表头映射）应明确：**从任意多列中识别并映射到系统所需的标准字段**，而不是依赖固定列名。
- 标准字段包括：公司名称、编号、型号、额定功率、气量、品牌、是否变频、额定压力、实际压力、运行时间、加载时间、数据记录日期等；供应商侧另有比功率等字段时也要支持多列映射。

## 上传与输入方式

**智能录入必须支持上传 Excel 文件（.xlsx、.xls）以及 CSV。**
- 上传入口：用户可选择「上传表格」，支持拖拽或点击选择 .csv、.xlsx、.xls 文件；首行为表头，与「从多列抽取所需列」能力配合，由 AI 识别并映射到标准字段。
- 不得移除或弱化 Excel 上传能力；若新增其他表格格式，需保持与现有 Excel/CSV 解析链路一致（表头 + 行 → 文本或结构化数据 → 大模型/解析）。

## 实现注意

- 大模型 prompt 中应明确列举「可接受的同义列名/多种写法」，并要求输出统一到上述标准字段。
- 若前端先做表头解析（如 CSV/Excel），再交给大模型时，尽量保留原始列名或整表文本，便于模型做列映射。
